Запустил под профайлером.

Можно оставить только треть времени, если избавиться от конструкторов строк, векторов и работы с памятью. То есть, прийти к сишной версии.
